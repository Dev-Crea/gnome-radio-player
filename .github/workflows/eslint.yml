name: ESLint

on:
    push:
        branches: ['main', 'dev']
    pull_request:
        branches: ['main']

jobs:
    eslint:
        name: Run eslint scanning
        runs-on: ubuntu-latest
        permissions:
            contents: read
            security-events: write
            # Required for private repositories by github/codeql-action/upload-sarif
            actions: read
        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Install
              run: |
                  npm install eslint@^9.14.0
                  npm install @microsoft/eslint-formatter-sarif@3.1.0

            - name: Lint
              env:
                SARIF_ESLINT_IGNORE_SUPPRESSED: "true"
              run: npx eslint .
                --config .eslintrc.js
                --ext .js
                --format @microsoft/eslint-formatter-sarif
                --output-file eslint-results.sarif
              continue-on-error: true

            - name: Report
              uses: github/codeql-action/upload-sarif@v3
              with:
                  sarif_file: eslint-results.sarif
                  wait-for-processing: true
